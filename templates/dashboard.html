<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - InstantApply</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
    <style>
        /* Improve vertical alignment in the search form */
        .job-search-form .form-group {
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .job-search-form .form-group input {
            height: 40px; /* Adjust height as needed */
            padding: 0 10px;
        }

        .search-button {
            height: 40px; /* Match the input height */
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 20px;
        }
    </style>
</head>
<body>
    <header class="top-header">
        <div class="brand">INSTANTAPPLY</div>
        <nav>
            <ul class="nav-left" style="margin-left: 1.5rem;">
                <li><a href="/profile">Profile</a></li>
                <li><a href="/applications">My Applications</a></li>
            </ul>
            <ul class="nav-right">
                <li><a href="/logout">Log Out</a></li>
            </ul>
        </nav>
    </header>
    
    <main>

        <!-- Single job search section -->
        <section class="search-section">
            <form id="job-search-form" action="#" method="GET" class="job-search-form" style="display: flex; align-items: center;">
                <div class="form-group" style="flex: 1; margin-right: 10px;">
                    <input type="text" id="job-title" name="title" placeholder="Job Title" required>
                </div>
                <div class="form-group" style="flex: 1; margin-right: 10px;">
                    <input type="text" id="location" name="location" placeholder="Location or Remote">
                </div>
                <button type="submit" class="search-button" style="margin-left: auto;">Search Jobs</button>
            </form>
            
            <div id="job-results" class="job-results-container">
                <!-- Jobs will be displayed here -->
            </div>
        </section>

        <section class="dashboard-stats">
            <div class="stat-card">
                <h4>Applications</h4>
                <p class="stat-number">{{ application_count if application_count is defined else 0 }}</p>
                <a href="/applications" class="view-all">View All</a>
            </div>
            <div class="stat-card">
                <h4>Profile Completion</h4>
                <div class="progress-bar">
                    <div class="progress" style="width: {{ profile_completion if profile_completion is defined else 0 }}%; 
                        background-color: {% if profile_completion < 33 %}#e74c3c{% elif profile_completion < 66 %}#f39c12{% else %}#2ecc71{% endif %};">
                    </div>
                </div>
                <p>{{ profile_completion if profile_completion is defined else 0 }}% Complete</p>
                {% if group_completions is defined %}
                <div class="completion-details" style="margin-top: 10px; font-size: 0.8em;">
                    <p style="margin-bottom: 5px; font-weight: bold;">Complete your profile:</p>
                    <ul style="list-style: none; padding-left: 0; margin-top: 5px;">
                        {% set categories = {
                            'basic_info': 'Basic Info',
                            'skills_experience': 'Skills & Experience', 
                            'resume': 'Resume',
                            'work_preferences': 'Work Preferences',
                            'additional_qualifications': 'Additional Qualifications',
                            'professional_details': 'Professional Details'
                        } %}
                        
                        {% for group, completion in group_completions.items() %}
                            {% if completion < 100 %}
                                <li style="margin-bottom: 3px;">
                                    <span style="color: {% if completion < 33 %}#e74c3c{% elif completion < 66 %}#f39c12{% else %}#2ecc71{% endif %}; display: inline-block;">
                                        {{ categories[group] }}: {{ completion }}%
                                    </span>
                                </li>
                            {% endif %}
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
                <a href="/profile" class="update-profile">Update Profile</a>
            </div>
        </section>

        <section class="recent-applications">
            <h3>Recent Applications</h3>
            {% if recent_applications is defined and recent_applications %}
                <div class="application-list">
                    {% for app in recent_applications %}
                    <div class="application-item">
                        <h4>{{ app.position }} at {{ app.company }}</h4>
                        <p class="status {{ app.status|lower }}">{{ app.status }}</p>
                        <p class="date">Applied: {{ app.submitted_at.strftime('%b %d, %Y') }}</p>
                    </div>
                    {% endfor %}
                </div>
                <a href="/applications" class="view-all">View All Applications</a>
            {% else %}
                <div class="empty-state">
                    <p>You haven't submitted any applications yet.</p>
                    <p>Start by searching for jobs that match your skills and interests.</p>
                </div>
            {% endif %}
        </section>
    </main>
    
    <footer>
        <p>&copy; 2023 InstantApply</p>
    </footer>
    
    <!-- Load dashboard JavaScript -->
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>
</html>